table 'Dim KPIs based on Last Year'
	lineageTag: 41c2f807-e98f-48eb-9be4-71c9427c7142

	column Target
		formatString: 0.00%;-0.00%;0.00%
		lineageTag: c75cedef-17b2-4d94-97f3-51c93edfff70
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Target]

		annotation SummarizationSetBy = Automatic

	column 'Shipping Plant'
		lineageTag: f5f55c96-fc95-42b9-ab9f-935e0b9d6a2e
		summarizeBy: none
		isNameInferred
		sourceColumn: [Shipping Plant]

		annotation SummarizationSetBy = Automatic

	column 'Target Type'
		lineageTag: c538e0a5-ebd7-4352-8d66-82ae2cbc85f8
		summarizeBy: none
		isNameInferred
		sourceColumn: [Target Type]

		annotation SummarizationSetBy = Automatic

	column Year
		formatString: 0
		lineageTag: 18f43e31-d758-4a6c-ac34-9e4470ba01af
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Year]

		annotation SummarizationSetBy = Automatic

	column Quarter
		lineageTag: cf412b08-186f-45a5-9774-adcd2e011df1
		summarizeBy: none
		isNameInferred
		sourceColumn: [Quarter]

		annotation SummarizationSetBy = Automatic

	column 'Year Quarter'
		lineageTag: 3486d5a2-b9a6-4ceb-949f-bc1580fa8874
		summarizeBy: none
		isNameInferred
		sourceColumn: [Year Quarter]

		annotation SummarizationSetBy = Automatic

	column Unit
		lineageTag: 9080ad51-0865-4cb2-9c1e-6e5cc72f163d
		summarizeBy: none
		isNameInferred
		sourceColumn: [Unit]

		annotation SummarizationSetBy = Automatic

	partition 'Dim KPIs based on Last Year' = calculated
		mode: import
		source = ```
				
				
				VAR QuarterlyTableIntermediate =
				    SUMMARIZE(
				        FILTER( /*Exclude staging time from the results*/
				            'Fact Table',
				            'Fact Table'[KPI] <> "Staging Time" 
				        ),
				        'Fact Table'[City],
				        'Dim Calendar'[Year],
				        'Dim Calendar'[Quarter],
				        'Fact Table'[KPI],
				        "Target",
				            CALCULATE(
				                DIVIDE(             /*It can happen that actual value is greater than the target value in some rows, 
				                            to avoid such cases MIN() function is used to consider target value instead of actual for such rows in the data.*/
				                    SUMX('Fact Table', MIN('Fact Table'[Actuals Value], 'Fact Table'[Target Value])), 
				                    SUM('Fact Table'[Target Value])
				                )
				            ),
				        "Target Type", "PY"
				    )
				
				
				VAR YearlyTableIntermediate = 
				    SUMMARIZECOLUMNS(
				        'Fact Table'[City],
				        'Dim Calendar'[Year],
				        'Fact Table'[KPI],
				        FILTER(
				            'Fact Table',
				            'Fact Table'[KPI] <> "Staging Time"
				        ),
				        "Target",
				            CALCULATE(
				                DIVIDE(             /*It can happen that actual value is greater than the target value in some rows, 
				                            to avoid such cases MIN() function is used to consider target value instead of actual for such rows in the data.*/
				                    SUMX('Fact Table', MIN('Fact Table'[Actuals Value], 'Fact Table'[Target Value])), 
				                    SUM('Fact Table'[Target Value])
				                )
				            ),
				        "Quarter", ""
				    )
				
				VAR ResultingYearlyTable = 
				    SELECTCOLUMNS(
				        YearlyTableIntermediate,
				        "Shipping Plant", 'Fact Table'[City],
				        "Target Type", "Yearly",
				        "Year", 'Dim Calendar'[Year],
				        "Quarter", "",
				        "Unit", 'Fact Table'[KPI],
				        "Target", [Target],
				                "Year Quarter", ""
				    )
				
				VAR ResultingQuarterlyTable = 
				    SELECTCOLUMNS(
				        QuarterlyTableIntermediate,
				        "Shipping Plant", 'Fact Table'[City],
				        "Target Type", "Quarterly",
				        "Year", 'Dim Calendar'[Year],
				        "Quarter", 'Dim Calendar'[Quarter],
				        "Unit", 'Fact Table'[KPI],
				        "Target", [Target],
				        "Year Quarter", CONCATENATE('Dim Calendar'[Year], 'Dim Calendar'[Quarter])
				    )
				
				RETURN
				    UNION(
				        ResultingQuarterlyTable,
				        ResultingYearlyTable
				    )
				
				
				```

	annotation PBI_Id = 73b7392f909e476e8d3fde334721b9a5

